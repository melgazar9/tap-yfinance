version: 1
send_anonymous_usage_stats: true
project_id: "tap-yfinance"
default_environment: test
environments:
  - name: test
plugins:
  extractors:
    - name: "tap-yfinance"
      namespace: "tap_yfinance"
      pip_url: -e .
      capabilities:
        - state
        - catalog
        - discover
        - about
        - stream-maps
      select:
        - stock_prices_1m
        - forex_prices_1m
        - crypto_prices_1m

      config:
        default_start_date: '1950-01-01'
        add_record_metadata: true

        financial_category:

          ### tickers ###

          tickers:
            stock_tickers:
              tickers: ["AAPL", "META"]
              schema_category: stock_tickers
            forex_tickers:
              tickers: ["EURUSD=X"]
              schema_category: forex_tickers
            crypto_tickers:
              tickers: ["BTC-USD", "ETH-USD"]
              schema_category: crypto_tickers

          ### prices ###

          prices:
            stock_prices_1m:
              tickers: ["AAPL", "META"]
              yf_params: {'interval': '1m', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: stock_prices
            stock_prices_1d:
              tickers: ["AAPL", "META"]
              yf_params: {'interval': '1d', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: stock_prices

            forex_prices_1m:
              tickers: ["EURUSD=X"]
              yf_params: {'interval': '1m', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: forex_prices
            forex_prices_1d:
              tickers: ["EURUSD=X"]
              yf_params: {'interval': '1d', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: forex_prices

            crypto_prices_1m:
              tickers: ["BTC-USD", "ETH-USD"]
              yf_params: {'interval': '1m', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: crypto_prices
            crypto_prices_1d:
              tickers: ["BTC-USD", "ETH-USD"]
              yf_params: {'interval': '1d', 'prepost': True, 'repair': True, 'auto_adjust': True, 'back_adjust': False}
              schema_category: crypto_prices

      metadata:
        '*':
          replication-method: INCREMENTAL
          replication-key: timestamp

  loaders:
    - name: target-jsonl
      variant: andyh1203
      pip_url: target-jsonl